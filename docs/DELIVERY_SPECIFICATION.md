# 📧 News Delivery System - 配信仕様書

## 📋 **配信概要**

**News Delivery System**は、複数のニュースソースから最新情報を自動収集・翻訳・分析し、定期的に美しいHTMLメールとPDF添付ファイルで配信するシステムです。

---

## ⏰ **配信スケジュール**

### **定期配信**（Linux Cron自動実行）

| 時刻 | 配信名 | 内容 | 頻度 |
|------|-------|------|------|
| **07:00** 🌅 | 朝のニュース | 前日夜～当日朝の最新ニュース | 毎日 |
| **12:00** 🌞 | 昼のニュース | 朝～昼の最新ニュース・市場情報 | 毎日 |
| **18:00** 🌆 | 夕方のニュース | 1日の重要ニュース総括 | 毎日 |

### **緊急配信**（自動トリガー）

| 条件 | 配信タイミング | 内容 |
|------|---------------|------|
| **重要度スコア 10/10** | 即座 | 重大ニュース速報 |
| **CVSSスコア 9.0以上** | 即座 | 重大セキュリティ脆弱性アラート |

---

## 📰 **収集・配信内容**

### **記事収集戦略**

#### **収集ソース**
- **NewsAPI**: メイン収集源（国内ニュース・国際の一部）
- **GNews API**: 補助収集源（国際ニュース・技術）
- **NVD Database**: セキュリティ脆弱性専用

#### **カテゴリ別収集詳細**

| カテゴリ | 記事数 | 収集源 | 言語 | 翻訳 |
|---------|-------|--------|------|------|
| **🇯🇵 国内社会** | 10記事 | NewsAPI | 日本語 | なし |
| **🌍 国際社会** | 15記事 | NewsAPI(7) + GNews(8) | 英語 | DeepL |
| **💴 国内経済** | 8記事 | NewsAPI | 日本語 | なし |
| **💰 国際経済** | 15記事 | NewsAPI(7) + GNews(8) | 英語 | DeepL |
| **💻 IT/技術** | 20記事 | NewsAPI(10) + GNews(10) | 英語 | DeepL |
| **🔒 セキュリティ** | 20記事 | NVD + NewsAPI | 英語 | DeepL |
| **合計** | **88記事** | **3ソース** | **混合** | **70記事** |

#### **収集キーワード**

**国際社会**: `human rights OR social justice OR migration`
**国際経済**: `global economy OR international trade OR world market`  
**技術**: `artificial intelligence OR machine learning OR cloud computing`
**セキュリティ**: `cybersecurity OR vulnerability OR CVE`

---

## 🌐 **翻訳・分析処理**

### **DeepL API Pro翻訳**
- **対象**: 英語記事のタイトル・本文
- **品質**: プロフェッショナル翻訳
- **容量**: 無制限（月額¥630）
- **処理時間**: 1記事あたり約0.5秒

### **Claude AI分析**
- **要約**: 各記事200-250文字の日本語要約
- **重要度**: 1-10スケールでの重要度評価
- **キーワード**: 5個のキーワード自動抽出
- **分類**: カテゴリ自動分類・センチメント分析

---

## 📧 **配信形式**

### **1. HTMLメール（メイン配信）**

#### **メール構成**
```
📧 Subject: 📰 ニュース配信レポート - 2025年08月08日
📨 From: kensan1969@gmail.com
📬 To: kensan1969@gmail.com
🎨 Format: HTML（レスポンシブデザイン）
```

#### **HTMLメールレイアウト**

**📊 ヘッダー部**
- システム名・配信日時
- グラデーション背景（青系プロフェッショナルデザイン）
- 配信種別（朝・昼・夕・緊急）

**📈 統計情報部**（4カラムグリッド）
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│ 総記事数      │ ソース数      │ 平均重要度    │ 緊急記事数    │
│    88       │     3       │    7.2      │     0       │
│   articles  │   sources   │   /10       │   urgent    │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

**📰 記事セクション**
各カテゴリごとに整理された記事一覧：

```
🇯🇵 国内社会ニュース（10記事）
├── 📄 記事タイトル
├── 📊 重要度バッジ（色分け）
├── 📝 200-250文字要約
├── 🏷️ キーワードタグ
├── 📡 配信元・公開日時
└── 🔗 元記事リンク

🌍 国際社会ニュース（15記事）
├── NewsAPI記事（7記事）
└── GNews記事（8記事）

（以下、各カテゴリ同様）
```

**🎯 重要度表示**
- **9-10**: 🔴 緊急（赤バッジ）
- **7-8**: 🟡 重要（黄バッジ）
- **5-6**: 🟢 通常（緑バッジ）
- **1-4**: ⚫ 軽微（グレーバッジ）

**📱 レスポンシブ対応**
- PC・スマートフォン・タブレット全対応
- 自動レイアウト調整
- 読みやすいフォントサイズ

### **2. PDF添付ファイル**

#### **PDF仕様**
- **形式**: A4サイズ、縦向き
- **内容**: HTMLメールと同じ内容
- **用途**: 印刷・保存・共有用
- **ファイル名**: `daily_news_report_YYYYMMDD.pdf`

#### **PDF構成**
- 表紙（システム名・日付・総記事数）
- 統計情報ページ
- カテゴリ別記事詳細
- 巻末情報（生成日時・システム情報）

---

## 🎨 **デザイン仕様**

### **カラーパレット**
- **プライマリー**: `#007bff` (Azure Blue)
- **セカンダリー**: `#0056b3` (Dark Blue)
- **背景**: `#f5f5f5` (Light Gray)
- **テキスト**: `#343a40` (Dark Gray)

### **フォント**
- **メイン**: Arial, sans-serif
- **見出し**: 太字、大きめサイズ
- **本文**: 通常ウェイト、読みやすいサイズ

### **アイコン使用**
- **📰** ニュース全般
- **🇯🇵** 国内ニュース  
- **🌍** 国際ニュース
- **💴💰** 経済ニュース
- **💻** 技術ニュース
- **🔒** セキュリティニュース
- **📊** 統計・データ
- **⚠️🚨** 緊急・重要

---

## 📊 **配信統計・品質管理**

### **配信実績管理**
- 配信成功・失敗の記録
- 記事数・ソース数の追跡
- 処理時間の記録
- エラーログの保存

### **品質保証**
- **重複除去**: URL・タイトルベースの自動削除
- **翻訳品質**: DeepL Pro による高品質翻訳
- **記事品質**: Claude AI による重要度評価
- **配信品質**: Gmail App Password による安定送信

### **監視・アラート**
- API使用量の監視
- システムエラーの自動通知
- 配信失敗時の自動リトライ（3回）
- ログローテーション（自動）

---

## 🔧 **技術仕様**

### **システム要件**
- **OS**: Linux (Ubuntu)
- **Python**: 3.11以降
- **実行方式**: Linux Cron（自動実行）
- **認証**: Gmail App Password

### **API制限・コスト**
| API | 使用量/月 | 制限 | コスト |
|-----|----------|------|--------|
| **NewsAPI** | 120req | 3,000req | 無料 |
| **GNews** | 90req | 3,000req | 無料 |
| **NVD** | 30req | 100,000req | 無料 |
| **DeepL Pro** | 1,155,000文字 | 無制限 | ¥630/月 |
| **Claude API** | 600req | 制限内 | 従量課金 |

### **データ保存**
- **データベース**: SQLite
- **記事保存**: JSON形式
- **レポート保存**: HTML/PDF
- **バックアップ**: 週次自動（日曜23:00）

---

## 📈 **配信効果・メリット**

### **情報収集の効率化**
- **時間節約**: 手動収集の90%削減
- **情報網羅**: 複数ソースで情報漏れ防止
- **品質向上**: AI分析による重要度判定

### **多様性・客観性**
- **ソース多様化**: NewsAPI + GNews で偏り軽減
- **多角的視点**: 同じトピックの複数記事
- **言語バリア解消**: 高品質日本語翻訳

### **システム安定性**
- **冗長性**: 複数APIで単一障害点回避
- **自動復旧**: エラー時の自動リトライ
- **継続運用**: 24時間365日安定配信

---

## 🎯 **利用者（kensan1969@gmail.com）への価値**

### **日常的な価値**
1. **朝7:00**: 起床時に最新情報で1日をスタート
2. **昼12:00**: ランチタイムに世界の動きを把握
3. **夕18:00**: 1日の総括で重要情報を整理

### **専門的な価値**
1. **IT管理者として**: セキュリティ脆弱性の即座把握
2. **意思決定者として**: 経済動向の迅速な情報収集
3. **グローバル視点**: 国際情勢の多角的理解

### **長期的な価値**
1. **知識蓄積**: 継続的な情報収集による見識向上
2. **効率向上**: 情報収集時間の大幅削減
3. **競争優位**: 最新情報への迅速なアクセス

---

## 📞 **サポート・メンテナンス**

### **自動メンテナンス**
- **データバックアップ**: 毎週日曜23:00
- **ログローテーション**: 自動実行
- **キャッシュクリア**: 定期実行

### **手動操作**
- **システム状況確認**: `./scripts/cron_management.sh status`
- **手動テスト実行**: `./scripts/cron_management.sh test`  
- **ログ確認**: `./scripts/cron_management.sh logs`

### **緊急時対応**
- **システム停止**: `./scripts/cron_management.sh remove`
- **システム再開**: `./scripts/cron_management.sh install`
- **手動実行**: `python3 src/main.py --mode daily`

---

**🎊 News Delivery System により、世界クラスの自動ニュース配信サービスを実現しています！**