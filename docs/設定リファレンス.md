# âš™ï¸ è¨­å®šãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

## ğŸ“‹ **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¦‚è¦**

ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ã‚·ã‚¹ãƒ†ãƒ ã®å…¨è¨­å®šé …ç›®ã€å½¢å¼ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ã¤ã„ã¦è©³ç´°ã«èª¬æ˜ã—ã¾ã™ã€‚

### **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ **
```
config/
â”œâ”€â”€ config.json              # ãƒ¡ã‚¤ãƒ³è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ config.json.example      # è¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â””â”€â”€ .env                     # ç’°å¢ƒå¤‰æ•°ï¼ˆæ©Ÿå¯†æƒ…å ±ï¼‰
```

---

## ğŸ”§ **ãƒ¡ã‚¤ãƒ³è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (config.json)**

### **å®Œå…¨è¨­å®šä¾‹**
```json
{
  "system": {
    "version": "1.0.0",
    "name": "ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ã‚·ã‚¹ãƒ†ãƒ ",
    "timezone": "Asia/Tokyo",
    "language": "ja",
    "debug": false,
    "max_workers": 5,
    "timeout": 30
  },
  "paths": {
    "data_root": "./data",
    "logs": "./logs",
    "cache": "./cache",
    "backup": "./backup",
    "templates": "./templates"
  },
  "api": {
    "newsapi": {
      "enabled": true,
      "base_url": "https://newsapi.org/v2",
      "timeout": 30,
      "rate_limit": 1000,
      "rate_window": 86400
    },
    "deepl": {
      "enabled": true,
      "base_url": "https://api-free.deepl.com/v2",
      "timeout": 30,
      "max_chars_per_request": 1000,
      "monthly_limit": 500000
    },
    "anthropic": {
      "enabled": true,
      "model": "claude-3-sonnet-20240229",
      "timeout": 60,
      "max_tokens": 1000,
      "daily_limit": 1000
    },
    "gnews": {
      "enabled": true,
      "base_url": "https://gnews.io/api/v4",
      "timeout": 30,
      "rate_limit": 100,
      "rate_window": 86400
    },
    "nvd": {
      "enabled": true,
      "base_url": "https://services.nvd.nist.gov/rest/json/cves/2.0",
      "timeout": 30
    }
  },
  "collection": {
    "categories": {
      "domestic_social": {
        "enabled": true,
        "count": 10,
        "priority": 1,
        "keywords": ["æ”¿æ²»", "çµŒæ¸ˆ", "ç¤¾ä¼š"],
        "exclude_keywords": ["èŠ¸èƒ½", "ã‚¹ãƒãƒ¼ãƒ„"],
        "sources": ["nhk.or.jp", "asahi.com", "mainichi.jp"]
      },
      "international_social": {
        "enabled": true,
        "count": 15,
        "priority": 2,
        "keywords": ["human rights", "social justice", "migration"],
        "exclude_keywords": ["sports", "entertainment"],
        "sources": ["bbc.co.uk", "reuters.com", "ap.org"]
      },
      "domestic_economy": {
        "enabled": true,
        "count": 8,
        "priority": 3,
        "keywords": ["æ ªä¾¡", "ç‚ºæ›¿", "é‡‘è"],
        "sources": ["nikkei.com", "bloomberg.co.jp"]
      },
      "international_economy": {
        "enabled": true,
        "count": 15,
        "priority": 4,
        "keywords": ["market", "economy", "trade", "inflation"],
        "sources": ["bloomberg.com", "reuters.com", "ft.com"]
      },
      "tech": {
        "enabled": true,
        "count": 20,
        "priority": 5,
        "keywords": ["AI", "machine learning", "cloud", "blockchain"],
        "exclude_keywords": ["gaming"],
        "sources": ["techcrunch.com", "arstechnica.com", "wired.com"]
      },
      "security": {
        "enabled": true,
        "count": 20,
        "priority": 6,
        "keywords": ["cybersecurity", "vulnerability", "ransomware"],
        "alert_threshold": 9.0,
        "cvss_threshold": 7.0,
        "sources": ["krebsonsecurity.com", "threatpost.com"]
      }
    },
    "global_settings": {
      "max_articles_per_run": 100,
      "deduplication": true,
      "quality_filter": true,
      "min_content_length": 100
    }
  },
  "translation": {
    "enabled": true,
    "target_language": "JA",
    "source_languages": ["EN", "auto"],
    "formality": "default",
    "preserve_formatting": true,
    "max_chars_per_article": 2000,
    "cache_translations": true,
    "cache_ttl": 86400
  },
  "ai_analysis": {
    "enabled": true,
    "model_config": {
      "temperature": 0.1,
      "max_tokens": 1000,
      "top_p": 0.9
    },
    "analysis_settings": {
      "summary_length": "200-250æ–‡å­—",
      "importance_scale": "1-10",
      "keywords_count": 5,
      "sentiment_analysis": true,
      "category_classification": true
    },
    "processing": {
      "priority_threshold": 7,
      "max_priority_articles": 20,
      "parallel_processing": 5,
      "timeout": 120
    },
    "fallback": {
      "enabled": true,
      "simple_analysis": true,
      "keyword_extraction": true
    }
  },
  "report_generation": {
    "formats": ["html", "pdf"],
    "html": {
      "template": "email_template.html",
      "responsive_design": true,
      "embed_css": true,
      "include_images": false
    },
    "pdf": {
      "enabled": true,
      "page_size": "A4",
      "margins": "0.75in",
      "font_family": "Arial, sans-serif",
      "font_size": "11pt"
    },
    "content": {
      "include_summary": true,
      "include_statistics": true,
      "include_urgent_alerts": true,
      "max_articles_per_category": 10,
      "show_source_links": true
    }
  },
  "delivery": {
    "enabled": true,
    "schedule": ["07:00", "12:00", "18:00"],
    "recipients": [
      {
        "email": "kensan1969@gmail.com",
        "name": "ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…",
        "categories": ["all"],
        "format": "html"
      }
    ],
    "sender": {
      "name": "ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ã‚·ã‚¹ãƒ†ãƒ ",
      "email": "system@example.com"
    },
    "email_settings": {
      "subject_format": "{time_icon} {edition}ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ - {date} {time}",
      "retry_attempts": 3,
      "retry_delay": 60,
      "timeout": 30
    },
    "urgent_notification": {
      "enabled": true,
      "importance_threshold": 10,
      "cvss_threshold": 9.0,
      "immediate_delivery": true,
      "subject_prefix": "ã€ç·Šæ€¥ã€‘"
    }
  },
  "database": {
    "type": "sqlite",
    "path": "./data/news.db",
    "backup_enabled": true,
    "backup_schedule": "daily",
    "retention_days": 90,
    "vacuum_schedule": "weekly",
    "connection_pool": {
      "max_connections": 10,
      "timeout": 30
    }
  },
  "cache": {
    "enabled": true,
    "type": "file",
    "ttl": {
      "api_responses": 3600,
      "translations": 86400,
      "analysis": 604800,
      "deduplication": 2592000
    },
    "cleanup": {
      "schedule": "daily",
      "max_size": "1GB",
      "retention_days": 30
    }
  },
  "logging": {
    "level": "INFO",
    "format": "[{time}] [{level}] [{module}] {message}",
    "rotation": {
      "max_file_size": "10MB",
      "backup_count": 5,
      "rotation_schedule": "daily"
    },
    "destinations": {
      "file": true,
      "console": true,
      "email": false
    },
    "sensitive_data_masking": true
  },
  "monitoring": {
    "enabled": true,
    "metrics": {
      "performance": true,
      "errors": true,
      "api_usage": true,
      "system_resources": true
    },
    "alerts": {
      "email": "kensan1969@gmail.com",
      "thresholds": {
        "error_rate": 0.05,
        "response_time": 30,
        "cpu_usage": 0.8,
        "memory_usage": 0.9,
        "disk_usage": 0.9
      }
    },
    "health_check": {
      "interval": 300,
      "endpoint": "/health",
      "timeout": 10
    }
  },
  "security": {
    "encryption": {
      "enabled": true,
      "algorithm": "AES-256",
      "key_rotation": "monthly"
    },
    "access_control": {
      "ip_whitelist": [],
      "rate_limiting": true,
      "request_timeout": 30
    },
    "audit": {
      "enabled": true,
      "log_level": "INFO",
      "retention_days": 365
    }
  },
  "performance": {
    "concurrent_requests": 10,
    "request_timeout": 30,
    "retry_policy": {
      "max_attempts": 3,
      "base_delay": 1,
      "max_delay": 60,
      "exponential_backoff": true
    },
    "connection_pooling": {
      "enabled": true,
      "max_connections": 20,
      "keep_alive": 30
    }
  },
  "experimental": {
    "features": {
      "advanced_deduplication": false,
      "multilingual_analysis": false,
      "real_time_alerts": false
    }
  }
}
```

---

## ğŸ”‘ **ç’°å¢ƒå¤‰æ•°è¨­å®š (.env)**

### **å¿…é ˆç’°å¢ƒå¤‰æ•°**
```bash
# APIèªè¨¼æƒ…å ±
NEWSAPI_KEY=your-newsapi-key-here
DEEPL_API_KEY=your-deepl-api-key-here
ANTHROPIC_API_KEY=your-claude-api-key-here
GNEWS_API_KEY=your-gnews-api-key-here

# Gmailè¨­å®š
GMAIL_USER=your-email@gmail.com
GMAIL_APP_PASSWORD=your-16-char-app-password

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
DATABASE_URL=sqlite:///./data/news.db

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
SECRET_KEY=your-secret-key-for-encryption
HASH_SALT=your-hash-salt

# å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
WEBHOOK_URL=https://your-webhook-endpoint.com
SLACK_WEBHOOK_URL=https://hooks.slack.com/your-webhook

# é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°è¨­å®š
DEBUG=false
LOG_LEVEL=INFO
ENVIRONMENT=production
```

### **ç’°å¢ƒå¤‰æ•°è©³ç´°èª¬æ˜**

#### **APIèªè¨¼**
| å¤‰æ•°å | å¿…é ˆ | èª¬æ˜ | å½¢å¼ä¾‹ |
|--------|------|------|--------|
| `NEWSAPI_KEY` | âœ… | NewsAPIèªè¨¼ã‚­ãƒ¼ | `a1b2c3d4e5f6...` (32æ–‡å­—) |
| `DEEPL_API_KEY` | âœ… | DeepL APIèªè¨¼ã‚­ãƒ¼ | `12345678-1234-1234-1234-123456789012:fx` |
| `ANTHROPIC_API_KEY` | âœ… | Claude APIèªè¨¼ã‚­ãƒ¼ | `sk-ant-api03-...` |
| `GNEWS_API_KEY` | âšª | GNews APIèªè¨¼ã‚­ãƒ¼ | `a1b2c3d4e5f6...` |

#### **Gmailè¨­å®š**
| å¤‰æ•°å | å¿…é ˆ | èª¬æ˜ | å–å¾—æ–¹æ³• |
|--------|------|------|---------|
| `GMAIL_USER` | âœ… | é€ä¿¡å…ƒGmailã‚¢ãƒ‰ãƒ¬ã‚¹ | Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆ |
| `GMAIL_APP_PASSWORD` | âœ… | ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ | Google 2æ®µéšèªè¨¼è¨­å®š |

---

## ğŸ“Š **è¨­å®šé …ç›®è©³ç´°**

### **ã‚·ã‚¹ãƒ†ãƒ è¨­å®š (system)**

#### **åŸºæœ¬è¨­å®š**
```json
{
  "system": {
    "version": "1.0.0",              // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
    "name": "ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ã‚·ã‚¹ãƒ†ãƒ ",    // ã‚·ã‚¹ãƒ†ãƒ å
    "timezone": "Asia/Tokyo",        // ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³
    "language": "ja",                // è¡¨ç¤ºè¨€èª
    "debug": false,                  // ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
    "max_workers": 5,                // æœ€å¤§ä¸¦è¡Œãƒ¯ãƒ¼ã‚«ãƒ¼æ•°
    "timeout": 30                    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ(ç§’)
  }
}
```

#### **ãƒ‘ã‚¹è¨­å®š (paths)**
```json
{
  "paths": {
    "data_root": "./data",           // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»è¨˜äº‹ä¿å­˜å…ˆ
    "logs": "./logs",                // ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜å…ˆ
    "cache": "./cache",              // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜å…ˆ
    "backup": "./backup",            // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿å­˜å…ˆ
    "templates": "./templates"       // HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¿å­˜å…ˆ
  }
}
```

### **APIè¨­å®š (api)**

#### **NewsAPIè¨­å®š**
```json
{
  "newsapi": {
    "enabled": true,                 // APIæœ‰åŠ¹åŒ–
    "base_url": "https://newsapi.org/v2",  // ãƒ™ãƒ¼ã‚¹URL
    "timeout": 30,                   // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ(ç§’)
    "rate_limit": 1000,              // ãƒ¬ãƒ¼ãƒˆåˆ¶é™(ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ—¥)
    "rate_window": 86400,            // ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦(ç§’)
    "endpoints": {
      "everything": "/everything",    // æ¤œç´¢ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
      "top_headlines": "/top-headlines"  // ãƒ˜ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
    }
  }
}
```

#### **DeepL APIè¨­å®š**
```json
{
  "deepl": {
    "enabled": true,
    "base_url": "https://api-free.deepl.com/v2",  // ç„¡æ–™ç‰ˆURL
    // "base_url": "https://api.deepl.com/v2",    // Proç‰ˆURL
    "timeout": 30,
    "max_chars_per_request": 1000,   // 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ãŸã‚Šæœ€å¤§æ–‡å­—æ•°
    "monthly_limit": 500000,         // æœˆé–“æ–‡å­—æ•°åˆ¶é™
    "formality": "default",          // æ•¬èªãƒ¬ãƒ™ãƒ«: default/more/less
    "preserve_formatting": true      // ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¿æŒ
  }
}
```

#### **Claude APIè¨­å®š**
```json
{
  "anthropic": {
    "enabled": true,
    "model": "claude-3-sonnet-20240229",  // ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«
    "timeout": 60,
    "max_tokens": 1000,              // æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°
    "daily_limit": 1000,             // æ—¥æ¬¡åˆ¶é™
    "temperature": 0.1,              // å‰µé€ æ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    "top_p": 0.9                     // ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  }
}
```

### **åé›†è¨­å®š (collection)**

#### **ã‚«ãƒ†ã‚´ãƒªè¨­å®šè©³ç´°**
```json
{
  "domestic_social": {
    "enabled": true,                 // ã‚«ãƒ†ã‚´ãƒªæœ‰åŠ¹åŒ–
    "count": 10,                     // åé›†è¨˜äº‹æ•°
    "priority": 1,                   // å„ªå…ˆåº¦(1ãŒæœ€é«˜)
    "keywords": ["æ”¿æ²»", "çµŒæ¸ˆ"],     // å¿…é ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
    "exclude_keywords": ["èŠ¸èƒ½"],     // é™¤å¤–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
    "sources": ["nhk.or.jp"],        // å„ªå…ˆã‚½ãƒ¼ã‚¹
    "language": "ja",                // è¨€èªæŒ‡å®š
    "country": "jp",                 // å›½æŒ‡å®š
    "sort_by": "relevancy",          // ã‚½ãƒ¼ãƒˆé †: relevancy/popularity/publishedAt
    "from_date": "2024-01-01",       // é–‹å§‹æ—¥(çœç•¥å¯)
    "to_date": null                  // çµ‚äº†æ—¥(çœç•¥å¯)
  }
}
```

### **ç¿»è¨³è¨­å®š (translation)**

#### **ç¿»è¨³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
```json
{
  "translation": {
    "enabled": true,
    "target_language": "JA",         // ç¿»è¨³å…ˆè¨€èª
    "source_languages": ["EN", "auto"],  // ç¿»è¨³å…ƒè¨€èª
    "formality": "default",          // æ•¬èªãƒ¬ãƒ™ãƒ«
    "preserve_formatting": true,     // ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¿æŒ
    "max_chars_per_article": 2000,   // è¨˜äº‹ã‚ãŸã‚Šæœ€å¤§æ–‡å­—æ•°
    "cache_translations": true,      // ç¿»è¨³çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥
    "cache_ttl": 86400,             // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿æŒæ™‚é–“(ç§’)
    "batch_size": 50,               // ãƒãƒƒãƒã‚µã‚¤ã‚º
    "parallel_requests": 3           // ä¸¦è¡Œãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
  }
}
```

### **AIåˆ†æè¨­å®š (ai_analysis)**

#### **åˆ†æãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
```json
{
  "ai_analysis": {
    "enabled": true,
    "model_config": {
      "temperature": 0.1,            // å‰µé€ æ€§(0.0-1.0)
      "max_tokens": 1000,            // æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°
      "top_p": 0.9,                  // ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ç¢ºç‡
      "frequency_penalty": 0.0,      // é »åº¦ãƒšãƒŠãƒ«ãƒ†ã‚£
      "presence_penalty": 0.0        // å­˜åœ¨ãƒšãƒŠãƒ«ãƒ†ã‚£
    },
    "analysis_settings": {
      "summary_length": "200-250æ–‡å­—",  // è¦ç´„æ–‡å­—æ•°
      "importance_scale": "1-10",     // é‡è¦åº¦ã‚¹ã‚±ãƒ¼ãƒ«
      "keywords_count": 5,            // æŠ½å‡ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ•°
      "sentiment_analysis": true,     // ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆåˆ†ææœ‰åŠ¹åŒ–
      "category_classification": true, // ã‚«ãƒ†ã‚´ãƒªåˆ†é¡æœ‰åŠ¹åŒ–
      "urgency_detection": true       // ç·Šæ€¥åº¦åˆ¤å®šæœ‰åŠ¹åŒ–
    }
  }
}
```

### **é…ä¿¡è¨­å®š (delivery)**

#### **é…ä¿¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**
```json
{
  "delivery": {
    "enabled": true,
    "schedule": ["07:00", "12:00", "18:00"],  // é…ä¿¡æ™‚åˆ»
    "timezone": "Asia/Tokyo",        // ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³
    "weekend_delivery": true,        // é€±æœ«é…ä¿¡
    "holiday_delivery": false,       // ç¥æ—¥é…ä¿¡
    "recipients": [
      {
        "email": "user@example.com",
        "name": "ãƒ¦ãƒ¼ã‚¶ãƒ¼å",
        "categories": ["all"],        // é…ä¿¡ã‚«ãƒ†ã‚´ãƒª
        "format": "html",            // é…ä¿¡å½¢å¼
        "language": "ja",            // è¨€èª
        "timezone": "Asia/Tokyo"     // ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³
      }
    ]
  }
}
```

#### **ç·Šæ€¥é€šçŸ¥è¨­å®š**
```json
{
  "urgent_notification": {
    "enabled": true,
    "importance_threshold": 10,      // é‡è¦åº¦é–¾å€¤
    "cvss_threshold": 9.0,          // CVSSã‚¹ã‚³ã‚¢é–¾å€¤
    "immediate_delivery": true,      // å³åº§é…ä¿¡
    "subject_prefix": "ã€ç·Šæ€¥ã€‘",    // ä»¶åãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
    "recipients": ["admin@example.com"],  // ç·Šæ€¥é€šçŸ¥å…ˆ
    "retry_attempts": 5,            // ãƒªãƒˆãƒ©ã‚¤å›æ•°
    "retry_delay": 300              // ãƒªãƒˆãƒ©ã‚¤é–“éš”(ç§’)
  }
}
```

---

## ğŸ”§ **è¨­å®šã®æ¤œè¨¼ã¨ç®¡ç†**

### **è¨­å®šæ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**
```python
# scripts/config_validator.py
import json
import os
from pathlib import Path
from typing import Dict, List, Any

class ConfigValidator:
    """è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼"""
    
    def __init__(self, config_path: str = "config/config.json"):
        self.config_path = Path(config_path)
        self.errors = []
        self.warnings = []
        
    def validate_config(self) -> Dict[str, Any]:
        """è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç·åˆæ¤œè¨¼"""
        
        result = {
            "valid": True,
            "errors": [],
            "warnings": [],
            "checks": {
                "file_exists": False,
                "json_valid": False,
                "required_fields": False,
                "field_types": False,
                "field_values": False,
                "env_vars": False
            }
        }
        
        # 1. ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
        if not self.config_path.exists():
            result["errors"].append(f"è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“: {self.config_path}")
            return result
        result["checks"]["file_exists"] = True
        
        # 2. JSONå½¢å¼ç¢ºèª
        try:
            with open(self.config_path, 'r', encoding='utf-8') as f:
                config = json.load(f)
        except json.JSONDecodeError as e:
            result["errors"].append(f"JSONå½¢å¼ã‚¨ãƒ©ãƒ¼: {e}")
            return result
        result["checks"]["json_valid"] = True
        
        # 3. å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ç¢ºèª
        required_fields = [
            "system", "api", "collection", "delivery"
        ]
        for field in required_fields:
            if field not in config:
                result["errors"].append(f"å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸è¶³: {field}")
        result["checks"]["required_fields"] = len(result["errors"]) == 0
        
        # 4. ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‹ç¢ºèª
        type_checks = [
            ("system.version", str),
            ("system.max_workers", int),
            ("collection.categories", dict),
            ("delivery.schedule", list)
        ]
        
        for field_path, expected_type in type_checks:
            if not self._check_field_type(config, field_path, expected_type):
                result["errors"].append(f"å‹ã‚¨ãƒ©ãƒ¼: {field_path} ã¯ {expected_type.__name__} ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™")
        
        # 5. å€¤ç¯„å›²ç¢ºèª
        value_checks = [
            ("system.max_workers", lambda x: 1 <= x <= 20),
            ("system.timeout", lambda x: 5 <= x <= 300),
            ("delivery.schedule", lambda x: len(x) > 0)
        ]
        
        for field_path, validator in value_checks:
            value = self._get_field_value(config, field_path)
            if value is not None and not validator(value):
                result["warnings"].append(f"å€¤ç¯„å›²è­¦å‘Š: {field_path} = {value}")
        
        # 6. ç’°å¢ƒå¤‰æ•°ç¢ºèª
        env_vars = ["NEWSAPI_KEY", "DEEPL_API_KEY", "ANTHROPIC_API_KEY", "GMAIL_USER"]
        for var in env_vars:
            if not os.getenv(var):
                result["warnings"].append(f"ç’°å¢ƒå¤‰æ•°æœªè¨­å®š: {var}")
        
        result["valid"] = len(result["errors"]) == 0
        result["errors"] = result["errors"]
        result["warnings"] = result["warnings"]
        
        return result
    
    def _check_field_type(self, config: dict, field_path: str, expected_type: type) -> bool:
        """ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‹ãƒã‚§ãƒƒã‚¯"""
        value = self._get_field_value(config, field_path)
        return value is not None and isinstance(value, expected_type)
    
    def _get_field_value(self, config: dict, field_path: str) -> Any:
        """ãƒã‚¹ãƒˆã—ãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤å–å¾—"""
        keys = field_path.split('.')
        value = config
        
        for key in keys:
            if isinstance(value, dict) and key in value:
                value = value[key]
            else:
                return None
                
        return value

# ä½¿ç”¨ä¾‹
if __name__ == "__main__":
    validator = ConfigValidator()
    result = validator.validate_config()
    
    if result["valid"]:
        print("âœ… è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯æœ‰åŠ¹ã§ã™")
    else:
        print("âŒ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™:")
        for error in result["errors"]:
            print(f"  - {error}")
    
    if result["warnings"]:
        print("âš ï¸ è­¦å‘Š:")
        for warning in result["warnings"]:
            print(f"  - {warning}")
```

### **è¨­å®šç®¡ç†ã‚³ãƒãƒ³ãƒ‰**
```bash
# è¨­å®šæ¤œè¨¼
python scripts/config_validator.py

# è¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
python scripts/generate_config_template.py

# è¨­å®šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
cp config/config.json backup/config_$(date +%Y%m%d_%H%M%S).json

# è¨­å®šå¾©å…ƒ
cp backup/config_20241210_120000.json config/config.json

# ç’°å¢ƒå¤‰æ•°ç¢ºèª
python scripts/check_env_vars.py

# è¨­å®šå·®åˆ†ç¢ºèª
diff config/config.json config/config.json.example
```

---

## ğŸ”„ **å‹•çš„è¨­å®šå¤‰æ›´**

### **ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰å¯¾å¿œ**
```python
# src/utils/config_manager.py
import json
import os
from pathlib import Path
from typing import Dict, Any, Callable
from watchdog.observers import Observer
from watchdog.events import FileSystemEventHandler

class ConfigManager:
    """å‹•çš„è¨­å®šç®¡ç†"""
    
    def __init__(self, config_path: str = "config/config.json"):
        self.config_path = Path(config_path)
        self.config = {}
        self.callbacks = []
        self.observer = None
        
        self.load_config()
        self.start_watching()
    
    def load_config(self) -> Dict[str, Any]:
        """è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿"""
        try:
            with open(self.config_path, 'r', encoding='utf-8') as f:
                self.config = json.load(f)
                
            # ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹ä¸Šæ›¸ã
            self._apply_env_overrides()
            
            return self.config
            
        except Exception as e:
            print(f"è¨­å®šèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")
            return {}
    
    def get(self, key: str, default: Any = None) -> Any:
        """è¨­å®šå€¤å–å¾—"""
        keys = key.split('.')
        value = self.config
        
        for k in keys:
            if isinstance(value, dict) and k in value:
                value = value[k]
            else:
                return default
                
        return value
    
    def set(self, key: str, value: Any) -> None:
        """è¨­å®šå€¤è¨­å®š"""
        keys = key.split('.')
        config = self.config
        
        for k in keys[:-1]:
            if k not in config:
                config[k] = {}
            config = config[k]
            
        config[keys[-1]] = value
        self.save_config()
    
    def save_config(self) -> None:
        """è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜"""
        try:
            with open(self.config_path, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, indent=2, ensure_ascii=False)
        except Exception as e:
            print(f"è¨­å®šä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
    
    def add_change_callback(self, callback: Callable) -> None:
        """å¤‰æ›´ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯è¿½åŠ """
        self.callbacks.append(callback)
    
    def start_watching(self) -> None:
        """ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–é–‹å§‹"""
        class ConfigChangeHandler(FileSystemEventHandler):
            def __init__(self, manager):
                self.manager = manager
                
            def on_modified(self, event):
                if event.src_path == str(self.manager.config_path):
                    print("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’æ¤œå‡ºã€å†èª­ã¿è¾¼ã¿ã—ã¾ã™")
                    old_config = self.manager.config.copy()
                    self.manager.load_config()
                    
                    # ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ
                    for callback in self.manager.callbacks:
                        callback(old_config, self.manager.config)
        
        self.observer = Observer()
        self.observer.schedule(
            ConfigChangeHandler(self),
            str(self.config_path.parent),
            recursive=False
        )
        self.observer.start()
    
    def _apply_env_overrides(self) -> None:
        """ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹è¨­å®šä¸Šæ›¸ã"""
        env_mappings = {
            'DEBUG': 'system.debug',
            'LOG_LEVEL': 'logging.level',
            'MAX_WORKERS': 'system.max_workers',
            'TIMEOUT': 'system.timeout'
        }
        
        for env_var, config_path in env_mappings.items():
            env_value = os.getenv(env_var)
            if env_value:
                # å‹å¤‰æ›
                if env_var in ['DEBUG']:
                    env_value = env_value.lower() in ['true', '1', 'yes']
                elif env_var in ['MAX_WORKERS', 'TIMEOUT']:
                    env_value = int(env_value)
                    
                self._set_nested_value(config_path, env_value)
    
    def _set_nested_value(self, path: str, value: Any) -> None:
        """ãƒã‚¹ãƒˆã—ãŸè¨­å®šå€¤è¨­å®š"""
        keys = path.split('.')
        config = self.config
        
        for key in keys[:-1]:
            if key not in config:
                config[key] = {}
            config = config[key]
            
        config[keys[-1]] = value
```

---

## ğŸ“‹ **è¨­å®šãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

### **åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
- [ ] `config.json` ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã‚³ãƒ”ãƒ¼
- [ ] å…¨API ã‚­ãƒ¼ã‚’å–å¾—ãƒ»è¨­å®š
- [ ] Gmail App Password è¨­å®š
- [ ] ãƒ‘ã‚¹è¨­å®šã®ç¢ºèªï¼ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå­˜åœ¨ï¼‰
- [ ] ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³è¨­å®šç¢ºèª
- [ ] é…ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹è¨­å®š

### **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèª**
- [ ] `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ (600)
- [ ] `config.json` ã®æ¨©é™ç¢ºèª
- [ ] `.gitignore` ã«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè¿½åŠ 
- [ ] ç’°å¢ƒå¤‰æ•°ã®æš—å·åŒ–ç¢ºèª
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®æš—å·åŒ–è¨­å®š

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
- [ ] ä¸¦è¡Œå‡¦ç†æ•°ã®æœ€é©åŒ–
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå€¤ã®èª¿æ•´
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®šã®æœ€é©åŒ–
- [ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è¨­å®šç¢ºèª
- [ ] ãƒãƒƒãƒã‚µã‚¤ã‚ºã®èª¿æ•´

### **é‹ç”¨æº–å‚™**
- [ ] ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
- [ ] ç›£è¦–é–¾å€¤ã®è¨­å®š
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥å…ˆè¨­å®š
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
- [ ] ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯è¨­å®š

---

**âš™ï¸ é©åˆ‡ãªè¨­å®šã«ã‚ˆã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ã®å®‰å®šæ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€å¤§åŒ–ã§ãã¾ã™ï¼**